<!DOCTYPE HTML>
<html><head><meta charset="UTF-8"><title>flappy-bird</title><script type="text/javascript" src="/elm-runtime.js"></script><script type="text/javascript">Elm.Main = Elm.Main || {};
Elm.Main.make = function (_elm) {
   _elm.Main = _elm.Main || {};
   if (_elm.Main.values)
   return _elm.Main.values;
   var _N = Elm.Native,
   _U = _N.Utils.make(_elm),
   _L = _N.List.make(_elm),
   _E = _N.Error.make(_elm),
   _J = _N.JavaScript.make(_elm),
   $moduleName = "Main";
   var Basics = Elm.Basics.make(_elm);
   var Color = Elm.Color.make(_elm);
   var Graphics = Graphics || {};
   Graphics.Collage = Elm.Graphics.Collage.make(_elm);
   var Graphics = Graphics || {};
   Graphics.Element = Elm.Graphics.Element.make(_elm);
   var Keyboard = Elm.Keyboard.make(_elm);
   var List = Elm.List.make(_elm);
   var Maybe = Elm.Maybe.make(_elm);
   var Native = Native || {};
   Native.Ports = Elm.Native.Ports.make(_elm);
   var Prelude = Elm.Prelude.make(_elm);
   var Random = Elm.Random.make(_elm);
   var Signal = Elm.Signal.make(_elm);
   var String = Elm.String.make(_elm);
   var Text = Elm.Text.make(_elm);
   var Time = Elm.Time.make(_elm);
   var Window = Elm.Window.make(_elm);
   var _op = {};
   var flappyColor = A3(Color.rgb,
   255,
   0,
   0);
   var displayBird = function (bird) {
      return Graphics.Collage.move({ctor: "_Tuple2"
                                   ,_0: 0
                                   ,_1: bird.y})(Graphics.Collage.filled(flappyColor)(A2(Graphics.Collage.oval,
      25,
      25)));
   };
   var pipeGreen = A3(Color.rgb,
   60,
   100,
   60);
   var drawPipe = F2(function (h,
   pipe) {
      return function () {
         var bottomPipeHeight = Basics.abs(0 - h / 2 - pipe.bottom);
         var topPipeHeight = Basics.abs(h / 2 - pipe.top);
         return _J.toList([Graphics.Collage.move({ctor: "_Tuple2"
                                                 ,_0: pipe.x
                                                 ,_1: h / 2 - topPipeHeight / 2})(Graphics.Collage.filled(pipeGreen)(A2(Graphics.Collage.rect,
                          50,
                          topPipeHeight)))
                          ,Graphics.Collage.move({ctor: "_Tuple2"
                                                 ,_0: pipe.x
                                                 ,_1: 0 - h / 2 + bottomPipeHeight / 2})(Graphics.Collage.filled(pipeGreen)(A2(Graphics.Collage.rect,
                          50,
                          bottomPipeHeight)))]);
      }();
   });
   var display = F2(function (_v0,
   game) {
      return function () {
         switch (_v0.ctor)
         {case "_Tuple2":
            return A2(Graphics.Collage.collage,
              _v0._0,
              _v0._1)({ctor: "::"
                      ,_0: displayBird(game.bird)
                      ,_1: A2(List.concatMap,
                      drawPipe(Basics.toFloat(_v0._1)),
                      game.pipes)});}
         _E.Case($moduleName,
         "between lines 98 and 100");
      }();
   });
   var near = F3(function (n,c,m) {
      return _U.cmp(m,
      n - c) > -1 && _U.cmp(m,
      n + c) < 1;
   });
   var collision = F2(function (bird,
   pipe) {
      return (A3(near,
      12.5,
      25,
      pipe.x) || A3(near,
      -12.5,
      25,
      pipe.x)) && (_U.cmp(bird.y,
      pipe.top) > 0 || _U.cmp(bird.y,
      pipe.bottom) < 0);
   });
   var flap = F2(function (f,
   bird) {
      return _U.replace([["acc"
                         ,f ? 7 : bird.acc]],
      bird);
   });
   var gravity = F2(function (d,
   bird) {
      return _U.replace([["y"
                         ,A2(Basics.max,
                         -300,
                         bird.y + bird.acc * d)]
                        ,["acc"
                         ,A2(Basics.max,
                         -50,
                         bird.acc - 0.8 * Math.pow(d,
                         2))]],
      bird);
   });
   var updateBird = F2(function (_v4,
   bird) {
      return function () {
         switch (_v4.ctor)
         {case "_Tuple4":
            return gravity(_v4._0)(A2(flap,
              _v4._1,
              bird));}
         _E.Case($moduleName,
         "on line 51, column 32 to 56");
      }();
   });
   var addPipe = F3(function (rand,
   _v10,
   game) {
      return function () {
         switch (_v10.ctor)
         {case "_Tuple2":
            return _U.cmp(game.countdown,
              0) < 1 ? {ctor: "::"
                       ,_0: {_: {}
                            ,bottom: -60 + rand
                            ,top: 60 + rand
                            ,x: _v10._0 / 2 + 50}
                       ,_1: game.pipes} : game.pipes;}
         _E.Case($moduleName,
         "between lines 37 and 39");
      }();
   });
   var movePipe = F2(function (d,
   pipe) {
      return _U.replace([["x"
                         ,pipe.x - 1.8 * d]],
      pipe);
   });
   var filterPipe = F2(function (_v14,
   pipe) {
      return function () {
         switch (_v14.ctor)
         {case "_Tuple2":
            return _U.cmp(pipe.x,
              (0 - _v14._0) / 2 - 50) > 0;}
         _E.Case($moduleName,
         "on line 33, column 26 to 47");
      }();
   });
   var updatePipes = F2(function (_v18,
   game) {
      return function () {
         switch (_v18.ctor)
         {case "_Tuple4":
            return List.filter(filterPipe(_v18._3))(List.map(movePipe(_v18._0))(A3(addPipe,
              _v18._2,
              _v18._3,
              game)));}
         _E.Case($moduleName,
         "between lines 42 and 44");
      }();
   });
   var updateCountdown = F2(function (_v24,
   countdown) {
      return function () {
         switch (_v24.ctor)
         {case "_Tuple4":
            return _U.cmp(countdown,
              0) < 1 ? 100 : countdown - _v24._0;}
         _E.Case($moduleName,
         "on line 31, column 42 to 87");
      }();
   });
   var Game = F4(function (a,
   b,
   c,
   d) {
      return {_: {}
             ,bird: c
             ,countdown: b
             ,pipes: a
             ,state: d};
   });
   var Bird = F2(function (a,b) {
      return {_: {},acc: b,y: a};
   });
   var Pipe = F3(function (a,b,c) {
      return {_: {}
             ,bottom: c
             ,top: b
             ,x: a};
   });
   var Dead = {ctor: "Dead"};
   var Playing = {ctor: "Playing"};
   var updateState = function (game) {
      return A2(List.any,
      collision(game.bird),
      game.pipes) ? Dead : Playing;
   };
   var stepPlaying = F2(function (input,
   game) {
      return _U.replace([["state"
                         ,updateState(game)]
                        ,["countdown"
                         ,A2(updateCountdown,
                         input,
                         game.countdown)]
                        ,["pipes"
                         ,A2(updatePipes,input,game)]
                        ,["bird"
                         ,A2(updateBird,
                         input,
                         game.bird)]],
      game);
   });
   var Waiting = {ctor: "Waiting"};
   var initialGame = {_: {}
                     ,bird: {_: {},acc: 0,y: 0}
                     ,countdown: 30
                     ,pipes: _J.toList([])
                     ,state: Waiting};
   var stepWaiting = F2(function (_v30,
   game) {
      return function () {
         switch (_v30.ctor)
         {case "_Tuple4":
            return _v30._1 ? _U.replace([["state"
                                         ,Playing]],
              initialGame) : initialGame;}
         _E.Case($moduleName,
         "between lines 74 and 76");
      }();
   });
   var $continue = function (flap) {
      return flap ? Waiting : Dead;
   };
   var stepDead = F2(function (_v36,
   game) {
      return function () {
         switch (_v36.ctor)
         {case "_Tuple4":
            return _U.replace([["state"
                               ,$continue(_v36._1)]
                              ,["bird"
                               ,A2(updateBird,
                               _v36,
                               game.bird)]],
              game);}
         _E.Case($moduleName,
         "between lines 71 and 72");
      }();
   });
   var step = F2(function (input,
   game) {
      return function () {
         var _v42 = game.state;
         switch (_v42.ctor)
         {case "Dead":
            return A2(stepDead,input,game);
            case "Playing":
            return A2(stepPlaying,
              input,
              game);
            case "Waiting":
            return A2(stepWaiting,
              input,
              game);}
         _E.Case($moduleName,
         "between lines 78 and 81");
      }();
   });
   var toFloat2 = function (_v43) {
      return function () {
         switch (_v43.ctor)
         {case "_Tuple2":
            return {ctor: "_Tuple2"
                   ,_0: Basics.toFloat(_v43._0)
                   ,_1: Basics.toFloat(_v43._1)};}
         _E.Case($moduleName,
         "on line 12, column 20 to 40");
      }();
   };
   var delta = A2(Signal._op["<~"],
   function (t) {
      return t / 20;
   },
   Time.fps(60));
   var inputSig = A2(Signal.sampleOn,
   delta,
   A2(Signal._op["~"],
   A2(Signal._op["~"],
   A2(Signal._op["~"],
   A2(Signal._op["<~"],
   F4(function (v0,v1,v2,v3) {
      return {ctor: "_Tuple4"
             ,_0: v0
             ,_1: v1
             ,_2: v2
             ,_3: v3};
   }),
   delta),
   Keyboard.space),
   A3(Random.range,
   -100,
   100,
   Time.every(2000))),
   A2(Signal.lift,
   toFloat2,
   Window.dimensions)));
   var gameSig = A3(Signal.foldp,
   step,
   initialGame,
   inputSig);
   var main = A3(Signal.lift2,
   display,
   Window.dimensions,
   gameSig);
   _elm.Main.values = {_op: _op
                      ,delta: delta
                      ,toFloat2: toFloat2
                      ,inputSig: inputSig
                      ,initialGame: initialGame
                      ,updateCountdown: updateCountdown
                      ,filterPipe: filterPipe
                      ,movePipe: movePipe
                      ,addPipe: addPipe
                      ,updatePipes: updatePipes
                      ,gravity: gravity
                      ,flap: flap
                      ,updateBird: updateBird
                      ,near: near
                      ,collision: collision
                      ,updateState: updateState
                      ,stepPlaying: stepPlaying
                      ,$continue: $continue
                      ,stepDead: stepDead
                      ,stepWaiting: stepWaiting
                      ,step: step
                      ,gameSig: gameSig
                      ,pipeGreen: pipeGreen
                      ,drawPipe: drawPipe
                      ,flappyColor: flappyColor
                      ,displayBird: displayBird
                      ,display: display
                      ,main: main
                      ,Waiting: Waiting
                      ,Playing: Playing
                      ,Dead: Dead
                      ,Pipe: Pipe
                      ,Bird: Bird
                      ,Game: Game};
   return _elm.Main.values;
};</script></head><body><script type="text/javascript">Elm.fullscreen(Elm.Main)</script><noscript></noscript></body></html>